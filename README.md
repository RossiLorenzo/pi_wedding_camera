# ğŸ“¸ Pi Wedding Camera

A handheld digital camera system built on a Raspberry Pi Zero W for capturing wedding photos. Photos are automatically synced to Google Photos when WiFi is available, and displayed in a live slideshow accessible from any device on the local network.

## ğŸ¯ Purpose

This project turns a Raspberry Pi Zero W with a Camera Module 3 into a dedicated wedding photo booth camera. Guests can take photos with a simple button press, and all photos are:

- **Saved locally** for immediate viewing on the slideshow
- **Automatically uploaded** to a shared Google Photos album
- **Offline-capable** - photos are queued and synced when WiFi reconnects

Perfect for weddings, parties, or any event where you want a fun, dedicated camera that automatically backs up to the cloud.

---

## ğŸ—ï¸ Current Setup

### Hardware
- **Raspberry Pi Zero W** (armv6l architecture)
- **Camera Module 3** (IMX708 sensor, 12MP)
- WiFi connection for Google Photos sync

### Software Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Pi Zero W                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   take_photo.sh              sync_service.py                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚   Fast capture (~2s)         Background daemon                  â”‚
â”‚   Saves to ~/Pictures        Monitors connectivity              â”‚
â”‚   Works OFFLINE âœ“            Uploads when online                â”‚
â”‚                                                                 â”‚
â”‚   app.py (Flask/Gunicorn)                                       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚   Slideshow web server       http://<pi-ip>:8000                â”‚
â”‚   Works on local network     No internet required               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Scripts & Files

### Core Scripts

| File | Purpose |
|------|---------|
| `take_photo.sh` | **Fast photo capture** (~2.3s). Shell script that bypasses Python for speed. Use this for the physical button trigger. |
| `main.py` | Python photo capture (~3s). Same functionality as shell script but useful for programmatic integration. |
| `sync_service.py` | **Background sync daemon**. Monitors internet connectivity and uploads pending photos to Google Photos. Runs as a systemd service. |
| `app.py` | **Flask web server**. Serves the live photo slideshow at `http://<pi-ip>:8000`. |
| `auth.py` | Google OAuth authentication. Run once to generate `token.json`. |
| `uploader.py` | Google Photos API integration. Handles album creation and photo uploads. |

### Configuration Files

| File | Purpose |
|------|---------|
| `wedding-slideshow.service` | Systemd service for Flask web server |
| `wedding-sync.service` | Systemd service for background sync |
| `requirements.txt` | Python dependencies |

### Generated Files (git-ignored)

| File | Purpose |
|------|---------|
| `token.json` | Google OAuth tokens (auto-generated by `auth.py`) |
| `client_secret_*.json` | Google Cloud credentials (download from console) |
| `album_id.txt` | Cached Google Photos album ID |
| `sync_state.json` | Tracks which photos have been uploaded |

---

## ğŸš€ Quick Start

### Taking Photos

```bash
# Fast capture (~2.3 seconds)
./take_photo.sh

# Or using Python (~3 seconds)
python main.py
```

Photos are saved to `~/Pictures/wedding_YYYYMMDD_HHMMSS.jpg`

### Viewing the Slideshow

Open in any browser on the same network:
```
http://<raspberry-pi-ip>:8000
```

### Checking Sync Status

```bash
# View sync service logs
sudo journalctl -u wedding-sync.service -f

# Check pending uploads
cat ~/pi_wedding_camera/sync_state.json
```

---

## â˜ï¸ Google Cloud Console Setup

To enable automatic photo uploads to Google Photos, you need to set up Google Cloud credentials.

### Step 1: Create a Google Cloud Project

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Click **Select a project** â†’ **New Project**
3. Name it (e.g., "Wedding Camera") and click **Create**

### Step 2: Enable the Photos Library API

1. Go to **APIs & Services** â†’ **Library**
2. Search for "Photos Library API"
3. Click on it and press **Enable**

### Step 3: Configure OAuth Consent Screen

1. Go to **APIs & Services** â†’ **OAuth consent screen**
2. Select **External** and click **Create**
3. Fill in the required fields:
   - App name: "Wedding Camera"
   - User support email: your email
   - Developer contact: your email
4. Click **Save and Continue**
5. On **Scopes**, click **Add or Remove Scopes** and add:
   - `https://www.googleapis.com/auth/photoslibrary.appendonly`
   - `https://www.googleapis.com/auth/photoslibrary.sharing`
6. Click **Save and Continue**
7. On **Test users**, click **Add Users** and add your Google account email
8. Click **Save and Continue**

### Step 4: Create OAuth Credentials

1. Go to **APIs & Services** â†’ **Credentials**
2. Click **Create Credentials** â†’ **OAuth client ID**
3. Application type: **Desktop app**
4. Name: "Wedding Camera"
5. Click **Create**
6. Click **Download JSON**
7. Rename the file to start with `client_secret_` (e.g., `client_secret_wedding.json`)
8. Copy it to your Pi:
   ```bash
   scp client_secret_*.json picamera@<pi-ip>:~/pi_wedding_camera/
   ```

### Step 5: Authenticate

Run the authentication script (easiest on a machine with a browser):

```bash
# On your Mac/PC (not the Pi)
cd pi_wedding_camera
python auth.py
```

This will:
1. Open a browser for Google sign-in
2. Ask you to authorize the app
3. Create `token.json` with your credentials

Copy the token to your Pi:
```bash
scp token.json picamera@<pi-ip>:~/pi_wedding_camera/
```

### Step 6: Start the Sync Service

On the Pi:
```bash
sudo cp wedding-sync.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable wedding-sync.service
sudo systemctl start wedding-sync.service
```

Photos will now automatically sync to your Google Photos album!

---

## ğŸ”§ Installation on Raspberry Pi

```bash
# Clone the repository
git clone <your-repo-url> ~/pi_wedding_camera
cd ~/pi_wedding_camera

# Create virtual environment
python3 -m venv venv
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Make scripts executable
chmod +x take_photo.sh

# Install systemd services
sudo cp wedding-slideshow.service /etc/systemd/system/
sudo cp wedding-sync.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable wedding-slideshow.service wedding-sync.service
sudo systemctl start wedding-slideshow.service wedding-sync.service
```

---

## ğŸ“‹ Camera Settings

Current optimized settings for fast handheld capture:

| Setting | Value | Reason |
|---------|-------|--------|
| Resolution | 2304x1296 (3MP) | Good quality, fast processing |
| Quality | 95% | Excellent JPEG quality |
| Denoise | Off | Preserves detail, faster |
| Autofocus | Continuous | Fast focus acquisition |
| Capture time | ~2.3 seconds | Hardware limit on Pi Zero W |

---

## ğŸ“ License

MIT License - Feel free to use and modify for your own events!
